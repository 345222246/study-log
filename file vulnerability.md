- 파일 공유 서비스를 개발할 때, 이용자가 업로드한 파일을 데이터베이스에 저장하는 것보다는 서버의 파일 시스템에 저장하는 것이 개발하기 쉽고, 관리 효율도 높다. 그러나 반대로, 임의 파일이 다운로드 되는 취약점이나, 악성 웹셸 파일을 업로드하여 입의 코드를 실행할 수 있는 취약점을 발생시키기도 한다. 
- 파일 업로드와 관련해서 발생하는 취약점은 파일 업로드 취약점이라고 하며, 반대로 내려 받을때 발생하는 취약점은 파일 다운로드 취약점이라고 한다. 

### file upload vulnerability
웹 서비스를 통해 이용자의 파일을 서버의 파일 시스템에 업로드하는 과정에서 발생하는 보안 취약점. 이용자가 업로드될 파일의 이름을 임의로 정할 수 있을 때 발생. 파일 이름에 이용자가 입력한 문자열을 그대로 사용하거나, 이용자의 이메일, 닉네임 등을 포함시키는 등의 소스 코드 패턴이 이러한 취약점 발생. 
크게 path traversal과 악성 파일 업로드로 분류된다. 파일 업로드를 허용하면 대개는 서비스는 보안을 위해 특정 디렉터리에만 업로드를 허용한다. 만약 이런 제한이 없다면, 악의적인 이용자가 웹 서버의 소스 코드나 서버에 있는 중요 시스템 파일을 덮어 쓸 위험이 있다. 
path traversal 취약점은 업로드에 존재하는 이러한 제약을 우회하여, 임의 디렉리에 파일을 업로드 할 수 있는 취약점을 말한다. 
아래는 파일 업로드 기능에 path traversal 취약점이 있는 코드이다. /fileupload는 post 요청을 받으면, 클라이언트가 전송한 파일을 ./uploads에 저장한다. 그런데 이용자가 입력한 파일 이름 f.filename 을 그대로 사용하기 때문에 path traversal에 취약하다. 예를 들어 공격자가 ../와 같은 메타문자를 사용하면 upload를 벗어나 상위 디렉터리에도 파일을 업로드할 수 있다. 

### 악성 파일 업로드
악성 파일 업로드 취약점은 이용자가 파일을 업로드할 때, 이를 제대로 검사하지 않아서 발생하는 취약점을 말한다. 
웹 서버는 .php, .jsp, .asp와 같은 확장자의 파일을 CGI로 실행하고 그 결과를 이용자에게 반환한다. 아래는 이용자가 요청한 파일의 확장자가 정규표현식을 만족하면, x-http-php로 핸들링하게 하는 apache 설정 파일이다. 
